# Item 18

## 상속보다는 컴포지션을 사용하라

- 패키지 경계를 넘어 다른 패키지의 구체 클래스를 상속하는 일은 위험
  - 상위 클래스에서 제공하는 메서드 구현이 바뀐다거나
  - 상위 클래스에서 새로운 메서드가 생긴다면
- Composition
  - 새로운 클래스를 만들고 private 필드로 기존 클래스의 인스턴스를 참조
  - 새 클래스의 인스턴스 메서드들은 기존 클래스에 대응하는 메서드 호출을 통해 결과를 반환
  - 기존 클래스의 구현이 바뀌더라도 영향을 받지 않음

## 완벽 공략

- 데코레이터 패턴
- 컴포지션과 전달 조합은 넓은 의미로 위임(delegation)
- 콜백 프레임워크와 셀프

### 데코레이터 패턴

- 기존 코드를 변경하지 않고 부가 기능을 추가하는 패턴
- 상속이 아닌 위임을 사용해서 보다 유연하게(런타임에) 부가 기능을 추가하는 것도 가능

### 콜백 프레임워크와 셀프 문제

- 콜백 프레임워크와 wrapper 를 같이 사용했을 때 발생할 수 있는 문제
- 콜백 함수
  - 다른 함수(A)의 인자로 전달된 함수(B) 
  - 해당 함수 내부(A)에서 필요한 시점에 호출될 수 있는 함수(B)
- 래퍼로 감싸고 있는 내부 객체가 어떤 클래스(A)의 콜백(B)으로 사용되는 경우, this 를 전달하면 해당 클래스(A)는 래퍼가 아닌 내부 객체(B)를 호출